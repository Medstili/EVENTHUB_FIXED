<ng-container *ngIf="event; else loading">
  <mat-card class="event-landing-card" 
            [@fadeInUp]
            [ngClass]="{'handset': (isHandset$ | async)}">
    <!-- Hero Image -->
    <div class="hero-image" 
         [@scaleIn]
         [style.backgroundImage]="'url(' + event.image_url + ')'">
      <div *ngIf="!canRegister" class="dark-overlay"></div>
      <div class="soldout-overlay" *ngIf="isSoldOut"></div>
      <div class="outdated-overlay" *ngIf="isOutdated"></div>
    </div>

    <!-- Title & Meta -->
    <div class="title-block" [@slideInUp]>
      <h1 class="event-title">{{ event.title }}</h1>
      <div class="meta">
        <span class="category-tag">{{ event.category?.name }}</span>
        <span><mat-icon>calendar_today</mat-icon>{{ event.date | date:'longDate' }}</span>
        <span><mat-icon>location_on</mat-icon>{{ event.location }}, {{ event.city }}</span>
      </div>
    </div>

    <!-- Main Content -->
    <div class="content-wrapper">
      <!-- Left: Description -->
      <div class="description" [@fadeInUp]>
        <h2>About this event</h2>
        <p class="event-description">{{ event.description }}</p>
      </div>

      <!-- Right: Sidebar / CTA -->
      <aside class="sidebar" [@fadeInUp]>
        <div class="info-card">
          <span class="price">
            {{ event.price === '0' ? 'Free' : (event.price | currency) }}
            <small *ngIf="event.price !== '0'">/ ticket</small>
          </span>
          
          <div class="info-item">
            <strong>Time</strong>
            <p>{{ event.time }}</p>
          </div>

          <div class="info-item">
            <strong>Availability</strong>
            <p>{{ event.capacity - event.current_registrations }} spots remaining</p>
          </div>

          <button class="btn btn-register" 
                  [disabled]="isSoldOut || isOutdated"
                  (click)="getTicket()">
            <mat-icon>{{ isSoldOut ? 'event_busy' : (isOutdated ? 'history' : 'payments') }}</mat-icon>
            <span>{{ isSoldOut ? 'Sold Out' : (isOutdated ? 'Event Ended' : 'Get Tickets') }}</span>
          </button>
        </div>
      </aside>
    </div>
  </mat-card>
</ng-container>

<ng-template #loading>
  <div class="loading-indicator-container">
    <mat-spinner color="warn" class="progress-spinner"></mat-spinner>
  </div>
</ng-template>