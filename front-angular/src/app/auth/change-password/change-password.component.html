<div class="change-password-container" 
     [class.mobile]="isMobile$ | async"
     [class.tablet]="isTablet$ | async"
     [class.desktop]="isDesktop$ | async"
     [@pageTransition]>
  
  <!-- Background with gradient and pattern -->
  <div class="background-overlay"></div>
  
  <div class="content-wrapper" [@fadeInUp]>
    <!-- Left side - Welcome section -->
    <div class="welcome-section" [@fadeInLeft]>
      <div class="welcome-content">
        <div class="logo-section">
          <div class="logo-icon">
            <mat-icon>lock_reset</mat-icon>
          </div>
          <h1 class="logo-text">EventHub</h1>
        </div>
        
        <div class="welcome-text">
          <h2 class="welcome-title">Reset Your Password</h2>
          <p class="welcome-description">
            Choose a strong password to secure your account. Make sure it's at least 8 characters long and includes a mix of letters, numbers, and symbols.
          </p>
        </div>
        
        <div class="security-tips">
          <h3 class="tips-title">Password Tips</h3>
          <ul class="tips-list">
            <li class="tip-item">
              <mat-icon class="tip-icon">check_circle</mat-icon>
              <span>Use at least 8 characters</span>
            </li>
            <li class="tip-item">
              <mat-icon class="tip-icon">check_circle</mat-icon>
              <span>Include uppercase and lowercase letters</span>
            </li>
            <li class="tip-item">
              <mat-icon class="tip-icon">check_circle</mat-icon>
              <span>Add numbers and special characters</span>
            </li>
            <li class="tip-item">
              <mat-icon class="tip-icon">check_circle</mat-icon>
              <span>Avoid common words and patterns</span>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Right side - Form section -->
    <div class="form-section" [@fadeInRight]>
      <div class="form-container">
        <div class="form-header">
          <h2 class="form-title">Choose New Password</h2>
          <p class="form-subtitle">Enter your new password below</p>
        </div>

        <form [formGroup]="form" (ngSubmit)="submit()" class="password-form" [@fadeInUp]>
          <input type="hidden" formControlName="token" />

          <!-- New Password Field -->
          <div class="form-group" [@fadeInUp]>
            <label class="form-label">
              <mat-icon class="label-icon">lock</mat-icon>
              New Password
            </label>
            <div class="password-input-container">
              <input 
                matInput 
                [type]="showPassword ? 'text' : 'password'"
                formControlName="password"
                class="form-input"
                placeholder="Enter your new password"
                [class.error]="form.get('password')?.invalid && form.get('password')?.touched"
              />
              <button 
                type="button" 
                class="password-toggle"
                (click)="togglePasswordVisibility('password')"
                [attr.aria-label]="showPassword ? 'Hide password' : 'Show password'">
                <mat-icon>{{ showPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
              </button>
            </div>
            <div class="form-error" *ngIf="form.get('password')?.invalid && form.get('password')?.touched">
              <mat-icon class="error-icon">error</mat-icon>
              <span *ngIf="form.get('password')?.hasError('required')">Password is required</span>
              <span *ngIf="form.get('password')?.hasError('minlength')">Password must be at least 8 characters</span>
            </div>
          </div>

          <!-- Confirm Password Field -->
          <div class="form-group" [@fadeInUp]>
            <label class="form-label">
              <mat-icon class="label-icon">lock_outline</mat-icon>
              Confirm Password
            </label>
            <div class="password-input-container">
              <input 
                matInput 
                [type]="showConfirmPassword ? 'text' : 'password'"
                formControlName="confirm"
                class="form-input"
                placeholder="Confirm your new password"
                [class.error]="form.hasError('mismatch') && form.get('confirm')?.touched"
              />
              <button 
                type="button" 
                class="password-toggle"
                (click)="togglePasswordVisibility('confirm')"
                [attr.aria-label]="showConfirmPassword ? 'Hide password' : 'Show password'">
                <mat-icon>{{ showConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
              </button>
            </div>
            <div class="form-error" *ngIf="form.hasError('mismatch') && form.get('confirm')?.touched">
              <mat-icon class="error-icon">error</mat-icon>
              <span>Passwords must match</span>
            </div>
          </div>

          <!-- Submit Button -->
          <button 
            type="submit" 
            class="btn btn-primary btn-full"
            [disabled]="form.invalid || isLoading"
            [@buttonPress]="buttonState"
            (mousedown)="buttonState = 'pressed'"
            (mouseup)="buttonState = 'normal'"
            (mouseleave)="buttonState = 'normal'">
            <mat-icon class="btn-icon" *ngIf="!isLoading">lock_reset</mat-icon>
            <div class="spinner" *ngIf="isLoading" [@spin]></div>
            <span>{{ isLoading ? 'Resetting Password...' : 'Reset Password' }}</span>
          </button>
        </form>

        <!-- Back to Login Link -->
        <div class="form-footer" [@fadeInUp]>
          <a routerLink="/login" class="back-link">
            <mat-icon class="link-icon">arrow_back</mat-icon>
            <span>Back to Login</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
